<!DOCTYPE html>
<header>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!--
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  -->
  <!-- Load d3.js -->
   <script src="./js/d3.v4.min.js" charset="utf-8"></script>
  <script src="./js/d3-queue.min.js"></script>
  <script src="./js/d3-chord.v0.0.min.js"></script>
</header>

<style>
.navlink-user{
  font-weight: bold;
}
</style>
<title>PAC2 Vistualització de dades</title>
<body>
  <nav class="navbar navbar-expand-md navbar-fixed-top navbar-light" role="navigation" role="navigation" style="background: #9aa698;">
      <div class="container">
            <a class="navbar-brand" href="#">PAC 2 Vistualització de dades</a>
            
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav">
                <li class="nav-item active" id="navbar1">
                  <a class="nav-link" href="#section1">Bar chart <span class="sr-only"></span></a>
                </li>
              </ul>
              <ul class="navbar-nav">
                <li class="nav-item active" id="navbar2">
                  <a class="nav-link" href="#section2">Small multiple <span class="sr-only"></span></a>
                </li>
              </ul>
              <ul class="navbar-nav">
                <li class="nav-item active" id="navbar3">
                  <a class="nav-link" href="#section3">Chord diagram <span class="sr-only"></span></a>
                </li>
              </ul>
            </div>
          
        </div>
  </nav>
</body> 
  <div>

   
</div>
<div class="section one" id="section1">
  section 1
</div>
<div class="section two" id="section2">
  section 2

</div>
<div class="section three" id="section3">
  <script>

    var width = 720,
        height = 720,
        outerRadius = Math.min(width, height) / 2 - 10,
        innerRadius = outerRadius - 24;
    
    var formatPercent = d3.format(".1%");
    
    var arc = d3.arc()
        .innerRadius(innerRadius)
        .outerRadius(outerRadius);
    
    var path = d3.ribbon()
        .radius(innerRadius);
    
    var chord_layout = d3.chord()
        .padAngle(0.01)
        .sortSubgroups(d3.descending)
        .sortGroups(d3.descending);    
    
    var svg = d3.select("#section3").append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g")
        .attr("id", "circle")
        .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");
    
    svg.append("circle")
        .attr("r", outerRadius);
    
    d3.queue()
        .defer(d3.json, "./data/pokemon.json")
        .await(ready);
    
    function ready(error, data) {
      if (error) throw error;
    
      var matrix = data.valuesData;
      var tipus = data.entities;
    
      var chord = chord_layout(matrix);
    
      var colorScale = d3.scaleOrdinal(d3.schemeCategory20b);
    
      // Añadimos una grupo por cada aeropuerto.
      var group = svg.selectAll(".group")
          .data(chord.groups)
        .enter().append("g")
          .attr("class", "group")
          .on("mouseover", mouseover);
    
      // Añadimos un campo title que se mostrará automaticamente en el mouseover.
      group.append("title").text(function(d, i) {
        return tipus[i] + ": " + d.value + " pokemons";
      });
    
      // Es dibuixa cada grup com un arc
      var groupPath = group.append("path")
          .attr("id", function(d, i) { return "group" + i; })
          .attr("d", arc)
          .style("fill", function(d, i) { return colorScale(i); });
    
      // Y a cada arco le añadimos un nombre.
      var groupText = group.append("text")
          .attr("x", 6)
          .attr("dy", 15);
    
      groupText.append("textPath")
          .attr("xlink:href", function(d, i) { return "#group" + i; })
          .text(function(d, i) { return tipus[i]; });
    
      // Para cada par de valores ciudad1-ciudad2 y ciudad2-ciudad1 se dibuja una cuerda
      var chord = svg.selectAll(".chord")
          .data(chord)
        .enter().append("path")
          .attr("class", "chord")
          .style("fill", function(d, i) { return colorScale(d.target.index); })
          .attr("d", path);
    
      // Añadimos un campo title como en el caso de los arcos pero algo más detellado
      chord.append("title").text(function(d) {
        return tipus[d.source.index]
            + " - " + tipus[d.target.index]
            + ": " + d.source.value;
      });
    
      function mouseover(d, i) {
        chord.classed("fade", function(p) {
          return p.source.index != i
              && p.target.index != i;
        });
      }
    }
    
    
    </script>
  
  <style>
    body {
      font-family: sans-serif;
      font-size: 16px;
      width: 960px;
      margin: 1em auto;
    }
    /* Specific Style */
    #circle circle {
      fill: none;
      pointer-events: all;
    }
    
    .group path {
      fill-opacity: .5;
    }
    
    path.chord {
      stroke: #000;
      stroke-width: .25px;
    }
    
    #circle:hover path.fade {
      display: none;
    }
    </style>
</div>

<script type="text/javascript">
  document.getElementById("navbar1").onclick = function() {
    document.getElementById("section2").style.display = "none";
    document.getElementById("section3").style.display = "none";
    document.getElementById("section1").style.display = "block";
  }

  document.getElementById("navbar2").onclick = function() {
    document.getElementById("section1").style.display = "none";
    document.getElementById("section3").style.display = "none";
    document.getElementById("section2").style.display = "block";
  }

  document.getElementById("navbar3").onclick = function() {
    document.getElementById("section1").style.display = "none";
    document.getElementById("section2").style.display = "none";
    document.getElementById("section3").style.display = "block";
  }
</script>